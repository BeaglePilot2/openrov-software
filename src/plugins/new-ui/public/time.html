<link rel="import" href="../../bower_components/polymer/polymer.html">

<polymer-element name="newui-time" attributes="time">
  <template>
    <style type="text/css">

      #time-container {
        display: table;
        color: #ffffff;
        width: 100%;
      }
      .time-row {
        display: table-row;
      }
      .time-cell {
        display: table-cell;
      }
      #time-container #time,
      #time-container #runtime
      {
        font-size: 2em;
      }
      .line-cell {
        display: table-cell;
        width: 50%; height: 5px
      }
      .description-cell {
        padding-left: 4px;
        padding-right: 4px;
        font-size: 0.9em;
      }
      .line-cell hr {
        display: block;
        height: 1px;
        border: 0;
        border-top: 0.1em solid white;
        margin: 0 0 .2em;
        padding: 0;
      }
      .text-center { text-align: center;}

    </style>
    <div id="time-container" class="center">
      <div class="time-row">
        <div id="time" class="time-cell text-center">{{time}}</div>
      </div>
      <div class="time-row">
        <div class="time-cell">
          <span class="line-cell"><hr /></span>
          <span class="time-cell description-cell text-center">RUN</span>
          <span class="line-cell"><hr /></span>
        </div>
      </div>
      <div class="time-row">
        <div id="runtime" class="time-cell text-center">{{ runtime }}</div>
      </div>
    </div>

  </template>
  <script>
    var socket = io.connect();
    Polymer({
      time: new Date().toLocaleTimeString(),
      runtime: "00:00:00",
      ready: function() {
        var self = this;

        var update = function () {
          self.time = new Date().toLocaleTimeString()
        };
        var formatRuntime = function (s) {
          function addZ(n) {
            return (n < 10 ? '0' : '') + n;
          }
          var ms = s % 1000;
          s = (s - ms) / 1000;
          var secs = s % 60;
          s = (s - secs) / 60;
          var mins = s % 60;
          var hrs = (s - mins) / 60;
          return addZ(hrs) + ':' + addZ(mins) + ':' + addZ(secs);  // + '.' + ms;
        };

        setInterval(update, 1000);

        socket.on('status', function(data) {
          if ('time' in data) {
            self.runtime = formatRuntime(data.time);
          }
        });
      }
    });
  </script>

</polymer-element>
  


